{% extends 'base.html.twig' %}

{% block title %}{{ parent() }}{% endblock %}


{% block content %}
<!-- Core CSS file -->
<link rel="stylesheet" href="{{ asset("theme2/css/photoswipe.css") }}"> 

<!-- Skin CSS file (styling of UI - buttons, caption, etc.)
     In the folder of skin CSS file there are also:
     - .png and .svg icons sprite, 
     - preloader.gif (for browsers that do not support CSS animations) -->
<link rel="stylesheet" href="{{ asset("theme2/css/default-skin.css") }}">

<!-- Core JS file -->
<script src="{{ asset("theme2/css/photoswipe.min.js") }}"></script> 

<!-- UI JS file -->
<script src="{{ asset("theme2/css/photoswipe-ui-default.min.js") }}"></script> 



	<link rel="stylesheet" href='{{ asset("theme2/css/style3.css") }}' >
<div style="background: #00944A!important; height:10px!important;">
               
        </div>

<div class="container">
  <div class="row">
    <div class="col-sm-12 col-xs-12 col-md-8">
      <div class="header_page_left">
        <h1>
          <a href="">
            {{prof.nom}} {{prof.ville}} {{prof.localisation}} {{prof.user.pays.nom}}
          </a>
        </h1>
      </div>
      <div class="body_page_left">
       <br/>
      </div>
      <div class="business_info" >
        <div class="row">
          <div class="col-md-2 col-sm-2 col-xs-3">
            <a href="" title="{{prof.nom}} {{prof.ville}} {{prof.localisation}} {{prof.user.pays.nom}}
">
              <img src="{{ asset(prof.user.webpath) }}" class="img-responsive img-pro" title="{{prof.nom}} {{prof.ville}} {{prof.localisation}} {{prof.user.pays.nom}}" alt="{{prof.nom}} {{prof.ville}} {{prof.localisation}} {{prof.user.pays.nom}}">
            </a>
          </div>
          <div class="col-md-10 col-sm-10 col-xs-9">
            <h2 itemprop="name">
              <a href="" title="{{prof.nom}} {{prof.ville}} {{prof.localisation}} {{prof.user.pays.nom}}">
               {{prof.nom}}  
              </a>
            </h2>
           
            <p class="address">
              <span >
                {{prof.ville}} {{prof.localisation}} 
              </span>
              <a href="" title="{{prof.ville}}">
                <span itemprop="addressLocality">
                  {{prof.user.pays.nom}} 
                </span>
                
              </a>
               <span >
                ({{ prof.user.pays.indicatif }}) {{ prof.fixe }} / {{ prof.tel }} 
              </span>
            </p>
           
            <div class="clearfix block_action">
              <div class="row">
                
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                  <a href="" title="Prendre RDV" class="btn btn-primary btn-block  prendreRDV">
                    Prendre 
                    rendez-vous
                    
                  </a>
                
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class="autres-infos">
        <div class="row">
          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h3>
             <i class="fa fa-bars" aria-hidden="true"></i> Présentation 
            </h3>
            <p>
             {{prof.presentation|raw}} 
            </p>

            <h3>
              <i class="fa fa-money" aria-hidden="true"></i> Prix minimum d'une consultation
            </h3>
            <p>
              {{prof.tarif}}
            </p>

             <h3>
              <i class="fa fa-money" aria-hidden="true"></i> Les spécialités et les Tarifs
            </h3>
            <p>
              <table id="demo-dt-delete" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Specialité</th>
                                            <th>Tarif</th>
                                            
                                        </tr>
                                    </thead>
                                    <tbody>

                                         {% for specialite in prof.specialite %}
                                            <tr>
                                                <td>{{ specialite.libele.libele }}</td>
                                                <td>{{ specialite.prix }} FCFA</td>
                                              
                                            </tr>
                                        {% endfor %}
                                        
                                      
                                    </tbody>
                                </table>
            </p>

             <h3>
             <i class="fa fa-mobile" aria-hidden="true"></i> Contacts 
            </h3>
            <p>
             ({{prof.user.pays.indicatif}}) {{prof.tel}} /  {{prof.fixe}} /  {{prof.user.email}}
              
            </p>

          

             <h3>
              <i class="fa fa-globe" aria-hidden="true"></i> Les langues parlées
            </h3>
            <p>
              {{prof.langue}} 
            </p>

            <h3>
              <i class="fa fa-calendar-times-o" aria-hidden="true"></i> Durée moyenne des consultations
            </h3>
            <p>
              {{prof.dure}} minutes
            </p> 

            <h3>
             <i class="fa fa-calendar" aria-hidden="true"></i>  Jour de Travail
            </h3>
            <p>
              {{prof.jour}} de {{prof.ouverture|date('H:i')}} à {{prof.fermeture|date('H:i')}}
            </p>

            

             <h3>
              <i class="fa fa-map-marker" aria-hidden="true"></i> Localisation
            </h3>
            <p>
              {{prof.localisation}} {{prof.ville}} {{prof.user.pays.nom}}
            </p>



          </div>
        </div>



      <div class="business_info" >
        <div class="row">
         
          <div class="col-md-10 col-sm-10 col-xs-9">


            
           
<section class="praticien__rdv  row" id="praticien__rdv" style="background-color:#f6f6f6!important;">
  <div class="">
    <div class="s-table">
      <div class="praticien__rdv__motive s-table-cell  col-sm-5">
        <h2>Prenez un rendez-vous directement en ligne
        </h2>




        <div class="form-group f-blue-select">
          <label  for="acts">Choisissez une spécialité
          </label>
          <br/>
              <select  id="searchCategory" name="searchCategory" class="search__doc-speciality" data-tags="false" data-placeholder="Choisissez une spécialité" required="" tabindex="-1" >
                                <option value=""></option>
                            {% for specialite in specialites %}
                                <option value="{{specialite}}">  {{specialite}} </option>

                            {% endfor %}
                                       
                </select>


           
        
        </div>
        <div class="second">

        </div>

     




      
      </div>
    
  </div>
</section>
          
           
          </div>
        </div>
      </div>






      </div>
    </div>
    <div class="col-md-4 hidden-xs hidden-sm right-bloc">
      <div class="map-pro t3" id="map-canvas" style="position: relative; overflow: hidden;">
        <div style="height: 100%; width: 100%; position: absolute; background-color: rgb(229, 227, 223);">
          <div class="gm-style" style="position: absolute; left: 0px; top: 0px; overflow: hidden; width: 100%; height: 100%; z-index: 0;">
          
          
           
      
       
          </div>
        </div>
      </div>
      <div class="partage-fiche-right">
        <p>
          Partager cette fiche :
        </p>
        <ul>
          <li>
            <a href="#" target="_blank" rel="nofollow"  class="fb">
              Partager {{prof.nom}} {{prof.ville}} {{prof.localisation}}  sur Facebook
            </a>
          </li>
          <li>
            <a href="#" target="_blank" rel="nofollow"  class="tw">
              Partager {{prof.nom}} {{prof.ville}} {{prof.localisation}} {{prof.user.pays.nom}} sur Twitter
            </a>
          </li>
         
        </ul>
      </div>
      <div class="partage-fiche-right">
        <p>
          Les avis sur 
          <strong>{{prof.nom}} {{prof.ville}} {{prof.localisation}} 
          </strong> 
        </p>
        <a href="#" class="btn btn-primary btn-block ">
          Voir les avis
        </a>
      </div>
      <div class="partage-fiche-right" style="background-color:white">




       <div class="rows my-gallery" itemscope itemtype="http://schema.org/ImageObject">
          {% for i in 0..8 %}
            {% if images.image[i] is defined  %}
              
              <figure class="col-md-4" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
              <a href="{{asset(images.image[i].webpath)}}" itemprop="contentUrl" data-size="964x1024">
                  <img src="{{asset(images.image[i].webpath)}}" itemprop="thumbnail" alt="Image description" />
              </a>
            </figure>

          {% endif %}
        {% endfor %}

       </div>
     



<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element, as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. PhotoSwipe keeps only 3 slides in DOM to save memory. -->
        <!-- don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

          </div>

        </div>

</div>
     
      
      </div>
    </div>
  </div>
</div>



<style type="text/css">
                .select2{
                }
.select2-container--default .select2-selection--single {
 border: 1px solid #00944A!important;
  height: 52px!important;
}

</style>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCisbCYkxNG986xTmgCSYXEVt1EP5NuFvw&amp;libraries=places"></script>
<script type='text/javascript' src='{{ asset("theme2/js/map.js") }} '></script>
<script type="text/javascript">
{% set lat  = "5.3615395" %} {% set lng  = "-4.0209782" %} {% set zoom  = "10" %}
{% if prof.lat != "" and prof.lng != "" %}
{% set lat  = prof.lat %} {% set lng  = prof.lng %} {% set zoom  = "15" %}

{% endif %}

var map;
function initMap() {
  map = new google.maps.Map(document.getElementById('map-canvas'), {
    center: {lat: {{lat}}, lng: {{lng}} },
    zoom: {{zoom}}
  });
}


var initPhotoSwipeFromDOM = function(gallerySelector) {

    // parse slide data (url, title, size ...) from DOM elements 
    // (children of gallerySelector)
    var parseThumbnailElements = function(el) {
        var thumbElements = el.childNodes, 
            numNodes = thumbElements.length,
            items = [],
            figureEl,
            linkEl,
            size,
            item;

        for(var i = 0; i < numNodes; i++) {

            figureEl = thumbElements[i]; // <figure> element

            // include only element nodes 
            if(figureEl.nodeType !== 1) {
                continue;
            }

            linkEl = figureEl.children[0]; // <a> element

            size = linkEl.getAttribute('data-size').split('x');

            // create slide object
            item = {
                src: linkEl.getAttribute('href'),
                w: parseInt(size[0], 10),
                h: parseInt(size[1], 10)
            };



            if(figureEl.children.length > 1) {
                // <figcaption> content
                item.title = figureEl.children[1].innerHTML; 
            }

            if(linkEl.children.length > 0) {
                // <img> thumbnail element, retrieving thumbnail url
                item.msrc = linkEl.children[0].getAttribute('src');
            } 

            item.el = figureEl; // save link to element for getThumbBoundsFn
            items.push(item);
        }

        return items;
    };

    // find nearest parent element
    var closest = function closest(el, fn) {
        return el && ( fn(el) ? el : closest(el.parentNode, fn) );
    };

    // triggers when user clicks on thumbnail
    var onThumbnailsClick = function(e) {
        e = e || window.event;
        e.preventDefault ? e.preventDefault() : e.returnValue = false;

        var eTarget = e.target || e.srcElement;

        // find root element of slide
        var clickedListItem = closest(eTarget, function(el) {
            return (el.tagName && el.tagName.toUpperCase() === 'FIGURE');
        });

        if(!clickedListItem) {
            return;
        }

        // find index of clicked item by looping through all child nodes
        // alternatively, you may define index via data- attribute
        var clickedGallery = clickedListItem.parentNode,
            childNodes = clickedListItem.parentNode.childNodes,
            numChildNodes = childNodes.length,
            nodeIndex = 0,
            index;

        for (var i = 0; i < numChildNodes; i++) {
            if(childNodes[i].nodeType !== 1) { 
                continue; 
            }

            if(childNodes[i] === clickedListItem) {
                index = nodeIndex;
                break;
            }
            nodeIndex++;
        }



        if(index >= 0) {
            // open PhotoSwipe if valid index found
            openPhotoSwipe( index, clickedGallery );
        }
        return false;
    };

    // parse picture index and gallery index from URL (#&pid=1&gid=2)
    var photoswipeParseHash = function() {
        var hash = window.location.hash.substring(1),
        params = {};

        if(hash.length < 5) {
            return params;
        }

        var vars = hash.split('&');
        for (var i = 0; i < vars.length; i++) {
            if(!vars[i]) {
                continue;
            }
            var pair = vars[i].split('=');  
            if(pair.length < 2) {
                continue;
            }           
            params[pair[0]] = pair[1];
        }

        if(params.gid) {
            params.gid = parseInt(params.gid, 10);
        }

        return params;
    };

    var openPhotoSwipe = function(index, galleryElement, disableAnimation, fromURL) {
        var pswpElement = document.querySelectorAll('.pswp')[0],
            gallery,
            options,
            items;

        items = parseThumbnailElements(galleryElement);

        // define options (if needed)
        options = {

            // define gallery index (for URL)
            galleryUID: galleryElement.getAttribute('data-pswp-uid'),

            getThumbBoundsFn: function(index) {
                // See Options -> getThumbBoundsFn section of documentation for more info
                var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail
                    pageYScroll = window.pageYOffset || document.documentElement.scrollTop,
                    rect = thumbnail.getBoundingClientRect(); 

                return {x:rect.left, y:rect.top + pageYScroll, w:rect.width};
            }

        };

        // PhotoSwipe opened from URL
        if(fromURL) {
            if(options.galleryPIDs) {
                // parse real index when custom PIDs are used 
                // http://photoswipe.com/documentation/faq.html#custom-pid-in-url
                for(var j = 0; j < items.length; j++) {
                    if(items[j].pid == index) {
                        options.index = j;
                        break;
                    }
                }
            } else {
                // in URL indexes start from 1
                options.index = parseInt(index, 10) - 1;
            }
        } else {
            options.index = parseInt(index, 10);
        }

        // exit if index not found
        if( isNaN(options.index) ) {
            return;
        }

        if(disableAnimation) {
            options.showAnimationDuration = 0;
        }

        // Pass data to PhotoSwipe and initialize it
        gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);
        gallery.init();
    };

    // loop through all gallery elements and bind events
    var galleryElements = document.querySelectorAll( gallerySelector );

    for(var i = 0, l = galleryElements.length; i < l; i++) {
        galleryElements[i].setAttribute('data-pswp-uid', i+1);
        galleryElements[i].onclick = onThumbnailsClick;
    }

    // Parse URL and open gallery if it contains #&pid=3&gid=1
    var hashData = photoswipeParseHash();
    if(hashData.pid && hashData.gid) {
        openPhotoSwipe( hashData.pid ,  galleryElements[ hashData.gid - 1 ], true, true );
    }
};

// execute above function
initPhotoSwipeFromDOM('.my-gallery');


$(document).ready(function() {

 var map = new GMaps({
    el: '#map-canvas',
    lat: {{lat}},
    lng: {{lng}}, 
    zoom: {{zoom}},
    zoomControl : true,
    zoomControlOpt: {
        style : 'SMALL',
        position: 'TOP_LEFT'
    },
    panControl : false,
  });

 map.addMarker({
      lat: {{lat}},
    lng: {{lng}}, 
      title: '{{prof.nom}} {{prof.ville}}',
      infoWindow: {
        content: '{{prof.presentation|raw}}' }
    });


$('.prendreRDV').click(function() {
  $("html,body").animate({scrollTop: $("#praticien__rdv").offset().top},1200, "easeOutBounce");
  return false;
  });


  $("#searchCategory").select2();

});

$('#searchCategory').change(function(){

 select =  $(this).val();

if($(this).val() != ""){
             $('.second').html('<div style="text-align:center" > <img src="{{ asset("theme2/images/gears.gif") }}"></div>');
             

             formdata = {specialite: $(this).val(), prof:"{{prof.id}}"  };

              $.ajax({
               url : "{{ path( 'front_rdv_specialite') }}",
               type : 'post',
               data : formdata  ,
               success : function( statut){

                        $('.second').html(statut);
                        $(".elem").select2();


      $('.docteur').change(function(){
          if($(this).val() != ""){
            ident = "0";
    var now = new Date();
    d =  now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate();
                                        formdata = {docteur: $(this).val() , semaine : d , id:ident  };

                                     
                $('.agenda').html('<div style="text-align:center" > <img src="{{ asset("theme2/images/gears.gif") }}"></div>');

            $.ajax({
               url : "{{ path( 'agenda_recherche1_ajax') }}",
               type : 'post',
               data : formdata  ,
               success : function( statut){

                        $('.agenda').html(statut);

                      },

               error : function(resultat, statut, erreur){

                if(statut){

                     error = '<div class="alert alert-dismissible alert-danger">' + 
                              '<button type="button" class="close" data-dismiss="alert">x</button>' + 
                               erreur + " ! veuillez recommencer " +
                            '</div>';
                 $('.agenda').html(error);
                }
                 
               }

              

            });



                                    }

            });





                      },

               error : function(resultat, statut, erreur){

                if(statut){

                     error = '<div class="alert alert-dismissible alert-danger">' + 
                              '<button type="button" class="close" data-dismiss="alert">x</button>' + 
                               erreur + " ! veuillez recommencer " +
                            '</div>';
                 $('.second').html(error);
                }
                 
               }

              

            });

}

});

</script>

{% endblock %}